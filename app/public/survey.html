<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Survey</title>
	<link type="text/css" rel="stylesheet" href="/public/css/style.css"/>
    <!-- Let browser know website is optimized for mobile-->
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
</head>
<body>
<h1 style="font-style: italic;">Survey Questions</h1>
<hr>
<h2 style="font-weight: bolder; font-style: italic;">About You</h2>
<div id="surveyPage">
  <form>
    <label for="name">Name (Required)</label>
    <input type="text" id="name" name="name">

    <label for="photo">Link to Photo Image (Required)</label>
    <input type="text" id="photo" name="photo">

    <label for="q1">Question 1<br>
    You find it difficult to introduce yourself to other people.<br></label>
    <select class="questions" id="q1" name="q1">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>

    <label for="q2"><br>Question 2<br>
    You often get so lost in thoughts that you ignore or forget your surroundings.<br></label>
    <select class="questions" id="q2" name="q2">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>

    <label for="q3"><br>Question 3<br>
    You try to respond to your e-mails as soon as possible and cannot stand a messy inbox.<br>
   </label>
    <select class="questions" id="q3" name="q3">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>

    <label for="q4"><br>Question 4<br>
    You find it easy to stay relaxed and focused even when there is some pressure.<br></label>
    <select class="questions" id="q4" name="q4">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>

    <label for="q4"><br>Question 5<br>
    You do not usually initiate conversations.<br>
    </label>
    <select class="questions" id="q5" name="q5">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>

    <label for="q6"><br>Question 6<br>
    You rarely do something just out of sheer curiosity.<br>
    </label>
    <select class="questions" id="q6" name="q6">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>

    <label for="q7"><br>Question 7<br>
    You feel superior to other people.<br>
    </label>
    <select class="questions" id="q7" name="q7">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>

    <label for="q8"><br>Question 8<br>
    Being organized is more important to you than being adaptable.<br>
    </label>
    <select class="questions" id="q8" name="q8">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>

    <label for="q9"><br>Question 9<br>
    You are usually highly motivated and energetic.<br>
    </label>
    <select class="questions" id="q9" name="q9">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>

    <label for="q10"><br>Question 10<br>
    You often feel as if you have to justify yourself to other people.<br>
    </label>
    <select class="questions" id="q10" name="q10">
      <option value=""></option>
      <option value="1">1 (Strongly Disagree)</option>
      <option value="2">2</option>
      <option value="3">3</option>
      <option value="4">4</option>
      <option value="5">5 (Strongly Agree)</option>
    </select>
  
    <input type="submit" value="Submit" id="submitBtn">
  </form>
</div>
  <footer>
    <!-- GET "/api/friends" -->
    <a href="/api/friends">API Friends List<a/> | <a href="https://github.com/clshu/Week13-HW11-FriendFinder">GitHub Repo<a/>
  </footer>

<!-- The Modal -->
<div id="myModal" class="modal">

<!-- Modal content -->
<div class="modal-content">
  <div class="modal-header">
    <span class="close">Ã—</span>
    <h2>Best Match</h2>
  </div>
  <div class="modal-body">
    <p id="matchName"></p>
    <p><img id="matchPhoto" src="" alt=""></p>
  </div>
  <div class="modal-footer">
    <h3>You Are Not Alone</h3>
  </div>
</div>

</div>

<script
  src="https://code.jquery.com/jquery-3.1.1.min.js"
  integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
  crossorigin="anonymous">
</script>

<script type="text/javascript">

	$("#submitBtn").on('click', function () {
    // The 'form's ability to sent GET is not taught on week13
    // so not required, use attribute "id" to get values
		var name = $("#name").val().trim();
		var photo = $("#photo").val().trim();
		var q1 = $("#q1").val();
		var q2 = $("#q2").val();
		var q3 = $("#q3").val();
		var q4 = $("#q4").val();
		var q5 = $("#q5").val();
		var q6 = $("#q6").val();
		var q7 = $("#q7").val();
		var q8 = $("#q8").val();
		var q9 = $("#q9").val();
		var q10 = $("#q10").val();

    //
    // validate it if all fields are filled out
    // 
		if (name && photo && q1 && q2 && q3 && q4 &&
     q5 && q6 && q7 && q8 && q9 && q10) {
			// do ajax post
      var user = {
        name: name,
        photo: photo,
        scores: [q1, q2, q3, q4, q5, q6, q7, q8, q9, q10]
      };
      console.log(user);
     
      var currentURL = window.location.origin;

      $.post(currentURL + "/api/friends", user, function(data){
        console.log(data);

        showModal(data);
      });
		} else {
			alert('Please fill out all fields before submitting.')
		}
		
    return false;
	});

  // Handling modal

  //
  // Fill out the name and photo in th modal then show modal
  //
  function showModal(data) {
    $("#matchName").html(data.name);
    $("#matchPhoto").attr("src", data.photo).attr("alt", data.name);
    $(".modal").show();
  }
  //
  // Hide modal by reloading the page
  // It sets class modal's display: none
  // It also cleans up name and photo fields on modal
  // and name, photo and quetions fields
  // on survey.html
  //
  function hideModal() {
    // reload page
    location.href = "/survey";    
  }
  //
  // When Close button "x" is click, it hides modal
  //
  $(".close").on('click', function () {
    hideModal();
  });
  //
  // When the user clicks outside of "modal-content" box,
  // It hides modal too.
  //
  $(document).on('click', function(event) {
 
    if ($(event.target).attr("id") == $(".modal").attr("id")) {
        hideModal();
    }
  });
</script>

</body>
</html>